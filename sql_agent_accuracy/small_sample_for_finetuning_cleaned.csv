question	sql_query
How many unique users had at least one fraudulent session in December 2024, broken down by country?	SELECT u.country, uniqExact(s.user_id) as unique_users FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfMonth(s.action_date) = '2024-12-01' AND s.is_fraud = 1 GROUP BY u.country format TabSeparatedWithNames
What was the total session duration for active users from the United States in 2024?	select sum(s.session_duration) from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'United States') AND (u.is_active = 1) and (toYear(action_date) = 2024) format TabSeparatedWithNames
How many sessions were marked as fraud in 2023?	select count(1) as fraud_sessions from ecommerce.sessions where (toStartOfYear(action_date) = '2023-01-01') and (is_fraud = 1) format TabSeparatedWithNames
What is the number of sessions in November 2024, broken down by browser types and user age groups, including the totals?	SELECT browser, CASE WHEN u.age < 30 THEN 'Under 30' WHEN u.age BETWEEN 30 AND 50 THEN '30-50' ELSE 'Over 50' END as age_group, uniqExact(session_id) as total FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfMonth(action_date) = '2024-11-01' GROUP BY browser, age_group with totals format TabSeparatedWithNames
How many customers in Germany made a purchase in January 2024?	select uniqExact(s.user_id) as customers from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2024-01-01') and (revenue > 0) and (u.country = 'Germany') format TabSeparatedWithNames
How many fraudulent sessions were recorded in December 2024, broken down by operating system?	SELECT os, countIf(is_fraud = 1) as fraudulent_sessions FROM ecommerce.sessions WHERE toStartOfMonth(action_date) = '2024-12-01' GROUP BY os format TabSeparatedWithNames
What was the total revenue generated by users from the United States in the first quarter of 2024?	select sum(sessions.revenue) as total_revenue from ecommerce.sessions as sessions join ecommerce.users as users on sessions.user_id = users.user_id where (toStartOfQuarter(sessions.action_date) = '2024-01-01') and (users.country = 'United States') format TabSeparatedWithNames
What is the average session duration for each browser used by active users in 2024?	SELECT browser, AVG(session_duration) as avg_duration FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfYear(action_date) = '2024-01-01' AND u.is_active = 1 GROUP BY browser format TabSeparatedWithNames
How many active users from Canada used Safari in October 2024?	select uniqExact(u.user_id) as active_users from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'Canada') AND (u.is_active = 1) and (s.browser = 'Safari') and (toStartOfMonth(action_date) = '2024-10-01') format TabSeparatedWithNames
What is the percentage of active users using Android in the current month?	select 100*uniqExactIf(user_id, os = 'Android')/uniqExact(user_id) as android_share from ecommerce.sessions join ecommerce.users on ecommerce.sessions.user_id = ecommerce.users.user_id where (toStartOfMonth(action_date) = toStartOfMonth(today())) and (is_active = 1) format TabSeparatedWithNames
What are the median and interquartile range (IQR) of session duration for each browser?	select browser, median(session_duration) as median_duration, quantile(0.25)(session_duration) as percentile_25_duration, quantile(0.75)(session_duration) as percentile_75_duration from ecommerce.sessions group by browser format TabSeparatedWithNames
How many customers used the Android operating system in December 2024?	select uniqExact(user_id) as customers from ecommerce.sessions where (toStartOfMonth(action_date) = '2024-12-01') and (os = 'Android') format TabSeparatedWithNames
What was the total session duration for active users from France in November 2023?	select sum(s.session_duration) from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'France') AND (u.is_active = 1) and (toStartOfMonth(action_date) = '2023-11-01') format TabSeparatedWithNames
What is the average session duration for each operating system, broken down by country?	SELECT u.country, s.os, AVG(s.session_duration) as average_duration FROM ecommerce.sessions AS s JOIN ecommerce.users AS u ON s.user_id = u.user_id GROUP BY u.country, s.os format TabSeparatedWithNames
Which browser has the highest share of active users with at least one fraudulent session?	select browser, 100*uniqExactIf(user_id, is_fraud = 1 and is_active = 1)/uniqExactIf(user_id, is_active = 1) as fraud_active_user_rate from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where u.is_active = 1 group by browser order by fraud_active_user_rate desc limit 1 format TabSeparatedWithNames
How many active users from France had sessions marked as fraud in 2023?	select uniqExact(s.user_id) as active_fraud_users from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfYear(action_date) = '2023-01-01') and (s.is_fraud = 1) and (u.country = 'France') and (u.is_active = 1) format TabSeparatedWithNames
What is the percentage of sessions marked as fraud for each browser type?	select browser, 100 * countIf(is_fraud = 1) / count() as fraud_percentage from ecommerce.sessions group by browser format TabSeparatedWithNames
How many active customers used the Safari browser in November 2024?	select uniqExact(s.user_id) as active_customers from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2024-11-01') and (browser = 'Safari') and (u.is_active = 1) format TabSeparatedWithNames
What is the average session duration for users aged 25-35 from Germany, segmented by operating system?	SELECT os, avg(session_duration) as avg_duration FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE u.age BETWEEN 25 AND 35 AND u.country = 'Germany' GROUP BY os format TabSeparatedWithNames
What was the share of users using Safari yesterday?	select 100*uniqExactIf(user_id, browser = 'Safari')/uniqExact(user_id) as safari_share from ecommerce.sessions where (action_date = today() - 1) format TabSeparatedWithNames
What are the median and interquartile range (IQR) of session duration for each operating system, excluding fraudulent sessions?	select os, median(session_duration) as median_duration, quantile(0.25)(session_duration) as percentile_25_duration, quantile(0.75)(session_duration) as percentile_75_duration from ecommerce.sessions where is_fraud = 0 group by os format TabSeparatedWithNames
How many active users were there in October 2024?	SELECT uniqExact(user_id) as active_users FROM ecommerce.users WHERE is_active = 1 AND user_id IN (SELECT user_id FROM ecommerce.sessions WHERE toStartOfMonth(action_date) = '2024-10-01') format TabSeparatedWithNames
What is the average session duration for Android users in Germany?	select avg(s.session_duration) as avg_session_duration from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where u.country = 'Germany' and s.os = 'Android' format TabSeparatedWithNames
Which browser contributes the highest share of total revenue?	select browser, 100*sum(revenue)/sum(sum(revenue)) over() as revenue_share from ecommerce.sessions group by browser order by revenue_share desc limit 1 format TabSeparatedWithNames
What is the average session duration for each browser in December 2024?	select browser, avg(session_duration) as avg_duration from ecommerce.sessions where toStartOfMonth(action_date) = '2024-12-01' group by browser format TabSeparatedWithNames
Which operating system has the highest share of fraud sessions in 2023?	select os, 100*countIf(is_fraud = 1)/count() as fraud_rate from ecommerce.sessions where toStartOfYear(action_date) = '2023-01-01' group by os order by fraud_rate desc limit 1 format TabSeparatedWithNames
What was the revenue from users in the United Kingdom aged between 30 and 50 in December 2024?	select sum(s.revenue) from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'United Kingdom') AND (u.age BETWEEN 30 AND 50) and (toStartOfMonth(action_date) = '2024-12-01') format TabSeparatedWithNames
What was the total revenue generated in December 2024, broken down by operating systems, including the totals?	SELECT os, sum(revenue) as total_revenue FROM ecommerce.sessions WHERE toStartOfMonth(action_date) = '2024-12-01' GROUP BY os WITH TOTALS format TabSeparatedWithNames
What was the share of users using Android today?	select 100*uniqExactIf(user_id, os = 'Android')/uniqExact(user_id) as android_share from ecommerce.sessions where (action_date = today()) format TabSeparatedWithNames
What is the total revenue generated by active users in Germany during Q2 2024?	SELECT sum(s.revenue) as total_revenue FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfQuarter(action_date) = '2024-04-01' AND u.country = 'Germany' AND u.is_active = 1 format TabSeparatedWithNames
Which browser was most frequently used by active users in France during January 2024?	select browser, count(browser) as usage_count from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'France') AND (u.is_active = 1) and (toStartOfMonth(action_date) = '2024-01-01') group by browser order by usage_count desc limit 1 format TabSeparatedWithNames
What was the average session duration for users in Germany aged 30 to 40 who used Chrome in January 2023?	select avg(s.session_duration) from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'Germany') AND (u.age between 30 and 40) and (s.browser = 'Chrome') and (toStartOfMonth(action_date) = '2023-01-01') format TabSeparatedWithNames
What was the percentage of fraudulent sessions from users in the United Kingdom using Safari in December 2024?	select 100 * countIf(s.is_fraud = 1) / count() as fraud_percentage from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'United Kingdom') and (s.browser = 'Safari') and (toStartOfMonth(action_date) = '2024-12-01') format TabSeparatedWithNames
What was the average session duration in seconds for sessions in January 2023 for users from the United Kingdom?	SELECT AVG(session_duration) as avg_duration FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfMonth(action_date) = '2023-01-01' AND u.country = 'United Kingdom' format TabSeparatedWithNames
How many sessions were marked as fraud in October 2024?	select count(session_id) as fraud_sessions from ecommerce.sessions where (toStartOfMonth(action_date) = '2024-10-01') and (is_fraud = 1) format TabSeparatedWithNames
Which operating system is most popular among active users in Germany?	select os, countDistinct(s.user_id) as active_users from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where u.country = 'Germany' and u.is_active = 1 group by os order by active_users desc limit 1 format TabSeparatedWithNames
What is the total revenue generated by active users from the United States in January 2024?	select sum(s.revenue) as total_revenue from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2024-01-01') and (u.country = 'United States') and (u.is_active = 1) format TabSeparatedWithNames
What was the total revenue generated from non-fraudulent sessions in December 2024?	select sum(revenue) as total_revenue from ecommerce.sessions where (toStartOfMonth(action_date) = '2024-12-01') and (is_fraud = 0) format TabSeparatedWithNames
What is the most commonly used operating system by active users in Germany in November 2023?	select os, count(*) as usage_count from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2023-11-01') and (u.country = 'Germany') and (u.is_active = 1) group by os order by usage_count desc limit 1 format TabSeparatedWithNames
Which operating system has the highest average revenue per session?	SELECT os, AVG(revenue) as avg_revenue FROM ecommerce.sessions GROUP BY os ORDER BY avg_revenue DESC LIMIT 1 format TabSeparatedWithNames
What is the total revenue generated by users from the United Kingdom using the Android OS in January 2025?	select sum(revenue) as total_revenue from ecommerce.sessions as s inner join ecommerce.users as u on u.user_id = s.user_id where (toStartOfMonth(action_date) = '2025-01-01') and (u.country = 'United Kingdom') and (s.os = 'Android') format TabSeparatedWithNames
What is the average session duration for active users by browser?	select browser, avg(session_duration) as average_session_duration from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id where u.is_active = 1 group by browser format TabSeparatedWithNames
Which operating system has the highest percentage of fraudulent sessions in Germany?	select os, 100*countIf(is_fraud = 1)/count() as fraud_percentage from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where u.country = 'Germany' group by os order by fraud_percentage desc limit 1 format TabSeparatedWithNames
What was the share of active users using Chrome yesterday?	select 100*uniqExactIf(s.user_id, s.browser = 'Chrome')/uniqExact(s.user_id) as chrome_share from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (s.action_date = today() - 1) and (u.is_active = 1) format TabSeparatedWithNames
What are the median and interquartile range (IQR) of session durations for each operating system, considering only active users in 2023?	select os, median(session_duration) as median_duration, quantile(0.25)(session_duration) as percentile_25_duration, quantile(0.75)(session_duration) as percentile_75_duration from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id where (u.is_active = 1) and (toStartOfYear(action_date) = '2023-01-01') group by os format TabSeparatedWithNames
Which country had the highest number of active users in 2023, excluding fraudulent sessions?	select country, count(distinct u.user_id) as active_users from ecommerce.users u inner join ecommerce.sessions s on u.user_id = s.user_id where u.is_active = 1 and toStartOfYear(s.action_date) = '2023-01-01' and s.is_fraud = 0 group by country order by active_users desc limit 1 format TabSeparatedWithNames
Which browser is used by the highest number of active users?	select browser, count(distinct user_id) as active_user_count from ecommerce.sessions as s inner join ecommerce.users as u on u.user_id = s.user_id where u.is_active = 1 group by browser order by active_user_count desc limit 1 format TabSeparatedWithNames
What is the average session duration for active users aged 30 to 40 years old?	select avg(session_duration) as average_session_duration from ecommerce.sessions as s inner join ecommerce.users as u on u.user_id = s.user_id where u.is_active = 1 and u.age between 30 and 40 format TabSeparatedWithNames
What was the average session duration for active users from the United Kingdom in January 2024?	SELECT avg(s.session_duration) as avg_duration FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfMonth(action_date) = '2024-01-01' AND u.country = 'United Kingdom' AND u.is_active = 1 format TabSeparatedWithNames
What are the average session duration and total revenue for each browser type, considering only non-fraudulent sessions?	SELECT browser, avg(session_duration) as avg_duration, sum(revenue) as total_revenue FROM ecommerce.sessions WHERE is_fraud = 0 GROUP BY browser format TabSeparatedWithNames
What is the average age of active users who made a purchase in 2023, grouped by country?	select country, avg(age) as average_age from ecommerce.users as u inner join ecommerce.sessions as s on u.user_id = s.user_id where is_active = 1 and revenue > 0 and toStartOfYear(action_date) = '2023-01-01' group by country format TabSeparatedWithNames
How many unique users made a purchase on January 15, 2025?	select uniqExact(user_id) as unique_users from ecommerce.sessions where action_date = '2025-01-15' and revenue > 0 format TabSeparatedWithNames
What is the average session duration and total revenue for each browser in 2023?	select browser, avg(session_duration) as avg_duration, sum(revenue) as total_revenue from ecommerce.sessions where (toStartOfYear(action_date) = '2023-01-01') group by browser format TabSeparatedWithNames
What is the average session duration for active users from France in January 2024?	SELECT avg(s.session_duration) as average_duration FROM ecommerce.sessions AS s INNER JOIN ecommerce.users AS u ON s.user_id = u.user_id WHERE (u.country = 'France') AND (u.is_active = 1) AND (toStartOfMonth(action_date) = '2024-01-01') FORMAT TabSeparatedWithNames
What is the average session duration for active users in the United Kingdom, grouped by browser type?	SELECT browser, avg(session_duration) as average_duration FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE u.country = 'United Kingdom' AND u.is_active = 1 GROUP BY browser format TabSeparatedWithNames
What are the median and interquartile range (IQR) of session duration for each operating system, excluding users under 30 years old?	select os, median(session_duration) as median_duration, quantile(0.25)(session_duration) as percentile_25_duration, quantile(0.75)(session_duration) as percentile_75_duration from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id where (u.age >= 30) group by os format TabSeparatedWithNames
What is the most popular operating system among active users in Germany in 2023?	select os, count(*) as usage_count from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where u.country = 'Germany' and u.is_active = 1 and toStartOfYear(action_date) = '2023-01-01' group by os order by usage_count desc limit 1 format TabSeparatedWithNames
What is the average session duration for fraudulent sessions, grouped by browser and country?	SELECT s.browser, u.country, AVG(s.session_duration) as avg_duration FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE s.is_fraud = 1 GROUP BY s.browser, u.country format TabSeparatedWithNames
What is the average revenue from fraudulent sessions for each operating system?	select os, avg(revenue) as avg_revenue from ecommerce.sessions where is_fraud = 1 group by os format TabSeparatedWithNames
What are the mean and standard deviation of session duration for each operating system, considering only active users?	select os, avg(session_duration) as mean_duration, stddevPop(session_duration) as stddev_duration from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id where u.is_active = 1 group by os format TabSeparatedWithNames
Which operating system is the most popular among users from France in 2023?	select os, count(*) as session_count from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where u.country = 'France' and toYear(action_date) = 2023 group by os order by session_count desc limit 1 format TabSeparatedWithNames
What are the median and interquartile range (IQR) of session duration for each browser, excluding fraudulent sessions?	select browser, median(session_duration) as median_duration, quantile(0.25)(session_duration) as percentile_25_duration, quantile(0.75)(session_duration) as percentile_75_duration from ecommerce.sessions where (is_fraud = 0) group by browser format TabSeparatedWithNames
What is the total revenue from non-fraud sessions in December 2024?	SELECT sum(revenue) as total_revenue FROM ecommerce.sessions WHERE toStartOfMonth(action_date) = '2024-12-01' AND is_fraud = 0 format TabSeparatedWithNames
What was the total session duration for users in Germany who used Safari in December 2024?	select sum(s.session_duration) as total_duration from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'Germany') AND (s.browser = 'Safari') and (toStartOfMonth(s.action_date) = '2024-12-01') format TabSeparatedWithNames
Which operating system has the highest share of fraud users in the United Kingdom in 2024?	select os, 100*uniqExactIf(user_id, is_fraud = 1)/uniqExact(user_id) as fraud_rate from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where u.country = 'United Kingdom' and toStartOfYear(action_date) = '2024-01-01' group by os order by fraud_rate desc limit 1 format TabSeparatedWithNames
What is the total revenue generated by each operating system, considering only active users?	select os, sum(revenue) as total_revenue from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id where (u.is_active = 1) group by os format TabSeparatedWithNames
How many active customers in Germany made a purchase using Chrome in November 2024?	select uniqExact(s.user_id) as active_customers from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2024-11-01') and (revenue > 0) and (u.country = 'Germany') and (u.is_active = 1) and (s.browser = 'Chrome') format TabSeparatedWithNames
How many active users from Germany used Chrome for fraudulent sessions in October 2024?	select uniqExact(s.user_id) as active_users from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2024-10-01') and (s.is_fraud = 1) and (u.is_active = 1) and (u.country = 'Germany') and (s.browser = 'Chrome') format TabSeparatedWithNames
How many customers using Android made a purchase in December 2024?	select uniqExact(s.user_id) as customers from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2024-12-01') and (revenue > 0) and (s.os = 'Android') format TabSeparatedWithNames
Which operating system has the highest average session duration for active users in the Netherlands?	select os, avg(session_duration) as avg_duration from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where u.country = 'Netherlands' and u.is_active = 1 group by os order by avg_duration desc limit 1 format TabSeparatedWithNames
What is the average session duration for each browser, categorized by fraud status?	SELECT browser, is_fraud, AVG(session_duration) as average_duration FROM ecommerce.sessions GROUP BY browser, is_fraud format TabSeparatedWithNames
What was the average session duration for active users in Germany using Chrome in January 2023?	select avg(s.session_duration) as average_duration from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'Germany') AND (u.is_active = 1) and (s.browser = 'Chrome') and (toStartOfMonth(action_date) = '2023-01-01') format TabSeparatedWithNames
What percentage of active users used Safari in the past week?	SELECT 100 * uniqExactIf(user_id, browser = 'Safari' AND is_active = 1) / uniqExactIf(user_id, is_active = 1) as safari_share FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE action_date >= today() - 7 format TabSeparatedWithNames
How many customers in Canada made a purchase in November 2024?	select uniqExact(s.user_id) as customers from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2024-11-01') and (revenue > 0) and (u.country = 'Canada') format TabSeparatedWithNames
Which country generated the highest total revenue from active users in non-fraudulent sessions?	select country, sum(revenue) as total_revenue from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id where is_fraud = 0 and is_active = 1 group by country order by total_revenue desc limit 1 format TabSeparatedWithNames
What is the average session duration for active users, grouped by browser?	select browser, avg(session_duration) as avg_duration from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id where u.is_active = 1 group by browser format TabSeparatedWithNames
What is the average session duration for active users in December 2024 from the United Kingdom?	SELECT avg(session_duration) as average_duration FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfMonth(action_date) = '2024-12-01' AND u.country = 'United Kingdom' AND u.is_active = 1 format TabSeparatedWithNames
Which country generated the highest revenue from users aged 18 and above in 2024?	select country, sum(revenue) as total_revenue from ecommerce.sessions as s inner join ecommerce.users as u on s.user_id = u.user_id where u.age >= 18 and toStartOfYear(action_date) = '2024-01-01' group by country order by total_revenue desc limit 1 format TabSeparatedWithNames
How many active customers made a purchase using an Android device in December 2024?	select uniqExact(s.user_id) as customers from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2024-12-01') and (revenue > 0) and (u.is_active = 1) and (os = 'Android') format TabSeparatedWithNames
What was the percentage of fraudulent sessions in the first quarter of 2024?	select 100*countIf(is_fraud = 1)/count() as fraud_percentage from ecommerce.sessions where (action_date >= '2024-01-01') and (action_date < '2024-04-01') format TabSeparatedWithNames
What is the total revenue generated by each operating system in December 2024?	SELECT os, sum(revenue) as total_revenue FROM ecommerce.sessions WHERE toStartOfMonth(action_date) = '2024-12-01' GROUP BY os format TabSeparatedWithNames
What is the percentage of fraud sessions for each operating system in the current month?	select os, 100*sum(is_fraud)/count(session_id) as fraud_percentage from ecommerce.sessions where (toStartOfMonth(action_date) = toStartOfMonth(now())) group by os order by fraud_percentage desc format TabSeparatedWithNames
What is the number of sessions in January 2025, broken down by browser for users from the United Kingdom, including the totals?	SELECT browser, uniqExact(session_id) as total FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfMonth(action_date) = '2025-01-01' AND u.country = 'United Kingdom' GROUP BY browser with totals format TabSeparatedWithNames
What was the revenue from Canadian users aged 40 and older who used Safari in November 2024?	select sum(s.revenue) from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'Canada') AND (u.age >= 40) and (s.browser = 'Safari') and (toStartOfMonth(action_date) = '2024-11-01') format TabSeparatedWithNames
How many active users had fraudulent sessions in September 2024?	select uniqExact(s.user_id) as active_fraud_users from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2024-09-01') and (is_fraud = 1) and (u.is_active = 1) format TabSeparatedWithNames
What was the average session duration by operating system in 2023?	select os, avg(session_duration) as average_session_duration from ecommerce.sessions where toStartOfYear(action_date) = '2023-01-01' group by os format TabSeparatedWithNames
What was the total session duration for users in the United States who used iOS in October 2024?	select sum(s.session_duration) as total_duration from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'United States') AND (s.os = 'iOS') and (toStartOfMonth(action_date) = '2024-10-01') format TabSeparatedWithNames
What is the average session duration for each operating system used by customers over 30 years old?	select os, avg(session_duration) as average_duration from ecommerce.sessions as s inner join ecommerce.users as u on u.user_id = s.user_id where u.age > 30 group by os format TabSeparatedWithNames
Which browser has the highest share of fraud sessions in the Netherlands?	SELECT browser, 100*countIf(is_fraud = 1)/count() as fraud_session_rate FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE u.country = 'Netherlands' GROUP BY browser ORDER BY fraud_session_rate DESC LIMIT 1 format TabSeparatedWithNames
Which browser was most used by active users in March 2023?	select browser, count(session_id) as session_count from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.is_active = 1) and (toStartOfMonth(action_date) = '2023-03-01') group by browser order by session_count desc limit 1 format TabSeparatedWithNames
How many unique active users from the United Kingdom made a purchase using an iOS device in 2024?	select uniqExact(s.user_id) as unique_active_users from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toYear(action_date) = 2024) and (revenue > 0) and (u.is_active = 1) and (u.country = 'United Kingdom') and (s.os = 'iOS') format TabSeparatedWithNames
What is the total revenue generated by each browser in France?	SELECT browser, sum(revenue) as total_revenue FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE u.country = 'France' GROUP BY browser format TabSeparatedWithNames
What was the most popular browser among active users in 2023, considering only non-fraudulent sessions?	SELECT browser, count(session_id) as session_count FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE s.is_fraud = 0 AND u.is_active = 1 AND toYear(action_date) = 2023 GROUP BY browser ORDER BY session_count DESC LIMIT 1 format TabSeparatedWithNames
What are the median and interquartile range (IQR) of session durations for active users, grouped by country and browser?	select country, browser, median(session_duration) as median_duration, quantile(0.25)(session_duration) as percentile_25_duration, quantile(0.75)(session_duration) as percentile_75_duration from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id where (is_active = 1) group by country, browser format TabSeparatedWithNames
What was the revenue from users in the Netherlands aged 30 and older who used Windows in November 2024?	select sum(s.revenue) from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'Netherlands') AND (u.age >= 30) and (s.os = 'Windows') and (toStartOfMonth(action_date) = '2024-11-01') format TabSeparatedWithNames
What was the average session duration for active users in the United States in the first quarter of 2024?	select avg(s.session_duration) as avg_duration from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'United States') AND (u.is_active = 1) and (action_date >= '2024-01-01' and action_date < '2024-04-01') format TabSeparatedWithNames
How many unique customers had fraudulent sessions in December 2024?	select uniqExact(user_id) as customers from ecommerce.sessions where (toStartOfMonth(action_date) = '2024-12-01') and (is_fraud = 1) format TabSeparatedWithNames
Which country generated the highest revenue from non-fraudulent sessions in 2023, excluding inactive users?	select country, sum(revenue) as total_revenue from ecommerce.sessions as s inner join ecommerce.users as u on s.user_id = u.user_id where is_fraud = 0 and u.is_active = 1 and toStartOfYear(action_date) = '2023-01-01' group by country order by total_revenue desc limit 1 format TabSeparatedWithNames
How many unique active customers had at least one session in December 2024?	SELECT uniqExact(s.user_id) as active_customers FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfMonth(action_date) = '2024-12-01' AND u.is_active = 1 format TabSeparatedWithNames
How many active users used Android in January 2024?	select uniqExact(s.user_id) as active_users from ecommerce.sessions as s inner join ecommerce.users as u on s.user_id = u.user_id where (toStartOfMonth(s.action_date) = '2024-01-01') and (s.os = 'Android') and (u.is_active = 1) format TabSeparatedWithNames
What is the average session duration for users aged 20-30 who have made at least one purchase?	select avg(session_duration) as avg_session_duration from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (u.age >= 20) and (u.age <= 30) and (s.revenue > 0) format TabSeparatedWithNames
Which operating system is used most frequently by users making purchases in 2024?	select os, countIf(revenue > 0) as purchase_sessions from ecommerce.sessions where toStartOfYear(action_date) = '2024-01-01' group by os order by purchase_sessions desc limit 1 format TabSeparatedWithNames
What is the most popular operating system among active users aged between 30 and 40 years old?	select os, count(session_id) as session_count from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where u.is_active = 1 and u.age between 30 and 40 group by os order by session_count desc limit 1 format TabSeparatedWithNames
What is the total revenue generated by users from the United Kingdom in December 2024, grouped by browser?	SELECT browser, sum(revenue) as total_revenue FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfMonth(action_date) = '2024-12-01' AND u.country = 'United Kingdom' GROUP BY browser format TabSeparatedWithNames
How many sessions were conducted by users aged between 30 and 40 using Chrome in January 2023?	select count(s.session_id) from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.age >= 30 AND u.age <= 40) and (s.browser = 'Chrome') and (toStartOfMonth(action_date) = '2023-01-01') format TabSeparatedWithNames
How many customers used Chrome to make a purchase in December 2024?	select uniqExact(s.user_id) as customers from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2024-12-01') and (revenue > 0) and (s.browser = 'Chrome') format TabSeparatedWithNames
What is the number of sessions in December 2024, broken down by browser for users from the United Kingdom, including the totals?	SELECT browser, uniqExact(session_id) as total FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfMonth(action_date) = '2024-12-01' AND u.country = 'United Kingdom' GROUP BY browser with totals format TabSeparatedWithNames
What is the average session duration by operating system in January 2024?	SELECT os, avg(session_duration) as average_duration FROM ecommerce.sessions WHERE toStartOfMonth(action_date) = '2024-01-01' GROUP BY os format TabSeparatedWithNames
Which country had the highest total revenue from active users in 2023?	select country, sum(revenue) as total_revenue from ecommerce.sessions as s inner join ecommerce.users as u on s.user_id = u.user_id where u.is_active = 1 and toStartOfYear(action_date) = '2023-01-01' group by country order by total_revenue desc limit 1 format TabSeparatedWithNames
What is the average session duration for active users from the United Kingdom in 2024?	SELECT avg(session_duration) as average_duration FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfYear(action_date) = '2024-01-01' AND u.country = 'United Kingdom' AND u.is_active = 1 format TabSeparatedWithNames
What was the average session duration in 2023, grouped by operating system?	select os, avg(session_duration) as average_duration from ecommerce.sessions where (toStartOfYear(action_date) = '2023-01-01') group by os format TabSeparatedWithNames
How many active users from the Netherlands used Android in December 2024?	select uniqExact(s.user_id) as active_users from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'Netherlands') AND (u.is_active = 1) and (toStartOfMonth(action_date) = '2024-12-01') and (os = 'Android') format TabSeparatedWithNames
What is the average session duration for fraudulent sessions in 2024?	select avg(session_duration) as avg_fraud_duration from ecommerce.sessions where is_fraud = 1 and toStartOfYear(action_date) = '2024-01-01' format TabSeparatedWithNames
What is the total revenue generated from sessions in December 2024 by users from the United Kingdom?	SELECT sum(revenue) as total_revenue FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfMonth(action_date) = '2024-12-01' AND u.country = 'United Kingdom' format TabSeparatedWithNames
What was the share of users using Chrome last week?	select 100*uniqExactIf(user_id, browser = 'Chrome')/uniqExact(user_id) as chrome_share from ecommerce.sessions where (action_date >= today() - 7 and action_date < today()) format TabSeparatedWithNames
What was the fraud rate in 2023, grouped by country, expressed as a percentage?	select users.country, 100*uniqExactIf(sessions.user_id, sessions.is_fraud = 1)/uniqExact(sessions.user_id) as fraud_rate from ecommerce.sessions join ecommerce.users on sessions.user_id = users.user_id where (toStartOfYear(sessions.action_date) = '2023-01-01') group by users.country format TabSeparatedWithNames
How many sessions were marked as fraud by French users in January 2025?	select count(s.session_id) as fraud_sessions from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'France') and (s.is_fraud = 1) and (toStartOfMonth(action_date) = '2025-01-01') format TabSeparatedWithNames
What is the average session duration in seconds for active users in 2023?	select avg(s.session_duration) as avg_session_duration from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfYear(action_date) = '2023-01-01') and (u.is_active = 1) format TabSeparatedWithNames
What is the total revenue generated in December 2024, broken down by operating systems?	SELECT os, sum(revenue) as total_revenue FROM ecommerce.sessions WHERE toStartOfMonth(action_date) = '2024-12-01' GROUP BY os format TabSeparatedWithNames
What is the number of fraudulent sessions in December 2024, broken down by country?	SELECT u.country, countIf(s.is_fraud = 1) as fraudulent_sessions FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfMonth(action_date) = '2024-12-01' GROUP BY u.country format TabSeparatedWithNames
Which countries have the highest percentage of fraudulent sessions, and what are those percentages?	SELECT country, 100 * sum(is_fraud) / count(session_id) as fraud_percentage FROM ecommerce.sessions AS s INNER JOIN ecommerce.users AS u ON s.user_id = u.user_id GROUP BY country ORDER BY fraud_percentage DESC format TabSeparatedWithNames
Which operating system has the highest average session duration for fraud sessions in 2024?	SELECT os, avg(session_duration) as avg_duration FROM ecommerce.sessions WHERE toStartOfYear(action_date) = '2024-01-01' AND is_fraud = 1 GROUP BY os ORDER BY avg_duration DESC LIMIT 1 format TabSeparatedWithNames
How many active users are there in non-fraud sessions, grouped by country and age group, including the totals?	SELECT country, CASE WHEN age < 30 THEN 'Under 30' WHEN age BETWEEN 30 AND 50 THEN '30-50' ELSE 'Over 50' END as age_group, countDistinct(user_id) as active_users FROM ecommerce.users u JOIN ecommerce.sessions s ON u.user_id = s.user_id WHERE is_active = 1 AND is_fraud = 0 GROUP BY country, age_group WITH TOTALS format TabSeparatedWithNames
What was the total revenue generated by users from the United States in Q2 2024?	select sum(revenue) as total_revenue from ecommerce.sessions as s inner join ecommerce.users as u on s.user_id = u.user_id where u.country = 'United States' and toStartOfQuarter(action_date) = '2024-04-01' format TabSeparatedWithNames
What are the average and standard deviation of session duration for each browser, excluding fraudulent sessions?	select browser, avg(session_duration) as average_duration, stddevPop(session_duration) as stddev_duration from ecommerce.sessions where is_fraud = 0 group by browser format TabSeparatedWithNames
How many unique active customers had at least one session in November 2024?	select uniqExact(user_id) as active_customers from ecommerce.sessions where toStartOfMonth(action_date) = '2024-11-01' and user_id in (select user_id from ecommerce.users where is_active = 1) format TabSeparatedWithNames
Which browser was most popular among users from Germany aged 30 and above in November 2024?	select browser, count(distinct s.user_id) as user_count from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'Germany') AND (u.age >= 30) and (toStartOfMonth(action_date) = '2024-11-01') group by browser order by user_count desc limit 1 format TabSeparatedWithNames
What was the total session duration for users aged 25-40 from Canada who used Chrome in January 2024?	select sum(s.session_duration) from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'Canada') AND (u.age >= 25 and u.age <= 40) and (s.browser = 'Chrome') and (toStartOfMonth(action_date) = '2024-01-01') format TabSeparatedWithNames
Which operating system is most commonly used by active users who made a purchase in 2024?	select os, count(distinct s.user_id) as user_count from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfYear(action_date) = '2024-01-01') and (revenue > 0) and (u.is_active = 1) group by os order by user_count desc limit 1 format TabSeparatedWithNames
What is the average session duration for users aged 20-25, grouped by browser?	select browser, avg(session_duration) as avg_session_duration from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (u.age >= 20) and (u.age <= 25) group by browser format TabSeparatedWithNames
How many active users from France had sessions in January 2024?	select uniqExact(s.user_id) as active_users from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2024-01-01') and (u.country = 'France') and (u.is_active = 1) format TabSeparatedWithNames
Which operating system was used the most by active users in 2024?	select os, count(distinct session_id) as sessions from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toYear(action_date) = 2024) and (u.is_active = 1) group by os order by sessions desc limit 1 format TabSeparatedWithNames
What was the most popular browser among active users in 2024?	select browser, count(distinct s.user_id) as active_users from ecommerce.sessions as s inner join ecommerce.users as u on s.user_id = u.user_id where u.is_active = 1 and toStartOfYear(s.action_date) = '2024-01-01' group by browser order by active_users desc limit 1 format TabSeparatedWithNames
Which country generated the highest revenue from fraud sessions in Q2 2023?	select country, sum(revenue) as total_revenue from ecommerce.sessions as s inner join ecommerce.users as u on s.user_id = u.user_id where is_fraud = 1 and toStartOfQuarter(action_date) = '2023-04-01' group by country order by total_revenue desc limit 1 format TabSeparatedWithNames
What was the average session duration for active users from the United States in 2024?	select avg(s.session_duration) as avg_session_duration from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfYear(s.action_date) = '2024-01-01') and (u.is_active = 1) and (u.country = 'United States') format TabSeparatedWithNames
What is the average session duration for each browser used by active users, excluding fraudulent sessions?	select browser, avg(session_duration) as avg_session_duration from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id where (is_fraud = 0) and (u.is_active = 1) group by browser format TabSeparatedWithNames
What is the average session duration for active users in 2023, broken down by browsers and user age groups?	SELECT browser, CASE WHEN u.age < 30 THEN 'Under 30' WHEN u.age BETWEEN 30 AND 50 THEN '30-50' ELSE 'Over 50' END as age_group, avg(session_duration) as average_duration FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfYear(action_date) = '2023-01-01' AND u.is_active = 1 GROUP BY browser, age_group format TabSeparatedWithNames
What was the total revenue generated by active users in the United States who used Chrome in November 2023?	select sum(s.revenue) from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'United States') AND (u.is_active = 1) and (s.browser = 'Chrome') and (toStartOfMonth(action_date) = '2023-11-01') format TabSeparatedWithNames
How many active customers in the Netherlands made a purchase in the first quarter of 2024?	select uniqExact(s.user_id) as active_customers from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfQuarter(action_date) = '2024-01-01') and (revenue > 0) and (u.country = 'Netherlands') and (u.is_active = 1) format TabSeparatedWithNames
How many active users had sessions marked as fraudulent in 2024?	select count(distinct u.user_id) as active_fraud_users from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id where s.is_fraud = 1 and u.is_active = 1 and toStartOfYear(s.action_date) = '2024-01-01' format TabSeparatedWithNames
What was the total revenue generated by active users from Germany in 2024?	select sum(s.revenue) as total_revenue from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where u.country = 'Germany' and u.is_active = 1 and toYear(s.action_date) = 2024 format TabSeparatedWithNames
Which operating system was most used by active users in November 2024?	select os, count(*) as usage_count from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2024-11-01') and (u.is_active = 1) group by os order by usage_count desc limit 1 format TabSeparatedWithNames
How many active customers aged 25-35 made a purchase in January 2024?	select uniqExact(s.user_id) as customers from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2024-01-01') and (revenue > 0) and (u.age >= 25) and (u.age <= 35) and (u.is_active = 1) format TabSeparatedWithNames
What was the annual fraud rate for Android users in 2022, expressed as a percentage?	select 100*uniqExactIf(user_id, is_fraud = 1)/uniqExact(user_id) as fraud_rate from ecommerce.sessions where (toStartOfYear(action_date) = '2022-01-01') and (os = 'Android') format TabSeparatedWithNames
Which are the top 5 countries with the highest average session duration for active users?	select country, avg(session_duration) as average_duration from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id where u.is_active = 1 group by country order by average_duration desc limit 5 format TabSeparatedWithNames
What was the total revenue generated by users over 30 in 2023, broken down by browser and ordered by revenue in descending order?	SELECT browser, sum(revenue) as total_revenue FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE u.age > 30 AND toYear(action_date) = 2023 GROUP BY browser ORDER BY total_revenue DESC format TabSeparatedWithNames
What is the total revenue generated by sessions on January 1st, 2024, broken down by browser for users aged 30 and above?	SELECT browser, sum(revenue) as total_revenue FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE action_date = '2024-01-01' AND u.age >= 30 GROUP BY browser format TabSeparatedWithNames
What percentage of sessions were marked as fraud for active users yesterday?	SELECT 100 * countIf(is_fraud = 1) / count() as fraud_percentage FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE action_date = today() - 1 AND u.is_active = 1 format TabSeparatedWithNames
Which operating system had the highest total session duration in 2023?	select os, sum(session_duration) as total_duration from ecommerce.sessions where (toStartOfYear(action_date) = '2023-01-01') group by os order by total_duration desc limit 1 format TabSeparatedWithNames
What was the most popular operating system used by customers in France during the first quarter of 2024?	select os, count(*) as session_count from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'France') and (action_date >= '2024-01-01' and action_date < '2024-04-01') group by os order by session_count desc limit 1 format TabSeparatedWithNames
Which operating system generated the highest revenue from fraudulent sessions in 2024?	SELECT os, sumIf(revenue, is_fraud = 1) as fraud_revenue FROM ecommerce.sessions WHERE toStartOfYear(action_date) = '2024-01-01' GROUP BY os ORDER BY fraud_revenue DESC LIMIT 1 format TabSeparatedWithNames
What is the average session duration and total revenue for each browser used by customers?	select browser, avg(session_duration) as avg_session_duration, sum(revenue) as total_revenue from ecommerce.sessions group by browser format TabSeparatedWithNames
What is the average session duration for active users, broken down by browser type?	SELECT browser, avg(session_duration) as average_duration FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE u.is_active = 1 GROUP BY browser format TabSeparatedWithNames
What is the total revenue generated by active users in November 2024?	select sum(revenue) as total_revenue from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2024-11-01') and (u.is_active = 1) format TabSeparatedWithNames
What is the average session duration for each browser, considering only active users and non-fraudulent sessions?	select browser, avg(session_duration) as average_duration from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id where (u.is_active = 1) and (s.is_fraud = 0) group by browser format TabSeparatedWithNames
What is the most used operating system by active users in Q2 2024?	select os, count(distinct s.user_id) as user_count from ecommerce.sessions as s inner join ecommerce.users as u on s.user_id = u.user_id where toStartOfQuarter(s.action_date) = '2024-04-01' and u.is_active = 1 group by os order by user_count desc limit 1 format TabSeparatedWithNames
Which browser generates the highest share of total revenue?	select browser, 100*sum(revenue)/sum(sum(revenue)) over() as revenue_share from ecommerce.sessions group by browser order by revenue_share desc limit 1 format TabSeparatedWithNames
How many active customers from the United Kingdom made a purchase in January 2024?	select uniqExact(s.user_id) as customers from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2024-01-01') and (revenue > 0) and (u.country = 'United Kingdom') and (u.is_active = 1) format TabSeparatedWithNames
What is the average session duration for each operating system used by active users?	select os, avg(session_duration) as avg_session_duration from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where u.is_active = 1 group by os format TabSeparatedWithNames
What is the total revenue generated by users from each country who are above 25 years old, grouped by browser type?	select country, browser, sum(revenue) as total_revenue from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id where u.age > 25 group by country, browser format TabSeparatedWithNames
What was the revenue from users in France aged 50 and older who used iOS in November 2024?	select sum(s.revenue) from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'France') AND (u.age >= 50) and (s.os = 'iOS') and (toStartOfMonth(action_date) = '2024-11-01') format TabSeparatedWithNames
What is the average session duration in December 2024 for users from the United Kingdom, broken down by browser?	SELECT browser, avg(session_duration) as avg_duration FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfMonth(action_date) = '2024-12-01' AND u.country = 'United Kingdom' GROUP BY browser format TabSeparatedWithNames
What was the share of users using Android three days ago?	select 100*uniqExactIf(user_id, os = 'Android')/uniqExact(user_id) as android_share from ecommerce.sessions where (action_date = today() - 3) format TabSeparatedWithNames
Which country had the highest total revenue from active users in 2024, excluding users under 18 years old?	select country, sum(revenue) as total_revenue from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfYear(action_date) = '2024-01-01') and (u.is_active = 1) and (u.age >= 18) group by country order by total_revenue desc limit 1 format TabSeparatedWithNames
What percentage of sessions were marked as fraud in 2023 for users using Android?	select 100*countIf(is_fraud = 1)/count() as fraud_percentage from ecommerce.sessions where (toStartOfYear(action_date) = '2023-01-01') and (os = 'Android') format TabSeparatedWithNames
Which operating system generated the highest revenue from fraudulent sessions in 2023?	select os, sum(revenue) as total_revenue from ecommerce.sessions where is_fraud = 1 and toYear(action_date) = 2023 group by os order by total_revenue desc limit 1 format TabSeparatedWithNames
What is the total revenue generated in December 2024, broken down by browsers for users from the United Kingdom, including the totals?	SELECT browser, sum(revenue) as total_revenue FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfMonth(action_date) = '2024-12-01' AND u.country = 'United Kingdom' GROUP BY browser with totals format TabSeparatedWithNames
What is the average session duration for active users in Germany during the first quarter of 2024?	SELECT avg(session_duration) as avg_session_duration FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfQuarter(action_date) = '2024-01-01' AND u.country = 'Germany' AND u.is_active = 1 format TabSeparatedWithNames
What was the average session duration for each browser in 2022?	select browser, avg(session_duration) as average_duration from ecommerce.sessions where toStartOfYear(action_date) = '2022-01-01' group by browser format TabSeparatedWithNames
What is the total revenue generated by sessions in December 2024, broken down by operating systems and browsers, including the totals?	SELECT os, browser, sum(revenue) as total_revenue FROM ecommerce.sessions WHERE toStartOfMonth(action_date) = '2024-12-01' GROUP BY os, browser with totals format TabSeparatedWithNames
What is the total revenue generated by active users from the United Kingdom in 2024, broken down by operating system?	SELECT os, sum(revenue) as total_revenue FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfYear(action_date) = '2024-01-01' AND u.country = 'United Kingdom' AND u.is_active = 1 GROUP BY os format TabSeparatedWithNames
What was the total revenue generated by active users in France during Q1 2024?	select sum(s.revenue) as total_revenue from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (action_date >= '2024-01-01' and action_date < '2024-04-01') and (u.is_active = 1) and (u.country = 'France') format TabSeparatedWithNames
What are the average and maximum purchase revenues for active users in Germany using iOS?	select avg(revenue) as avg_revenue, max(revenue) as max_revenue from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id where (u.country = 'Germany') and (u.is_active = 1) and (s.os = 'iOS') and (s.revenue > 0) format TabSeparatedWithNames
How many active customers made a purchase in January 2024?	select uniqExact(s.user_id) as active_customers from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2024-01-01') and (revenue > 0) and (u.is_active = 1) format TabSeparatedWithNames
What was the average session duration for users aged 20-30 in 2022?	select avg(s.session_duration) as average_duration from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfYear(action_date) = '2022-01-01') and (u.age >= 20) and (u.age <= 30) format TabSeparatedWithNames
What is the average session duration in December 2024, broken down by browsers for active users from the United Kingdom?	SELECT browser, avg(session_duration) as average_duration FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfMonth(action_date) = '2024-12-01' AND u.country = 'United Kingdom' AND u.is_active = 1 GROUP BY browser format TabSeparatedWithNames
Which country has the highest share of fraud users?	select country, 100*uniqExactIf(user_id, is_fraud = 1)/uniqExact(user_id) as fraud_rate from ecommerce.users u join ecommerce.sessions s on u.user_id = s.user_id group by country order by fraud_rate desc limit 1 format TabSeparatedWithNames
How many active users from the United Kingdom made a purchase in February 2024?	select uniqExact(s.user_id) as active_users from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfMonth(action_date) = '2024-02-01') and (revenue > 0) and (u.country = 'United Kingdom') and (u.is_active = 1) format TabSeparatedWithNames
Which operating system had the highest fraud session rate in 2024?	select os, 100*countIf(is_fraud = 1)/count() as fraud_session_rate from ecommerce.sessions where toStartOfYear(action_date) = '2024-01-01' group by os order by fraud_session_rate desc limit 1 format TabSeparatedWithNames
What is the most popular operating system among active users in Germany?	select os, count(*) as os_count from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where u.country = 'Germany' and u.is_active = 1 group by os order by os_count desc limit 1 format TabSeparatedWithNames
What was the average session duration for active users in 2023, grouped by country?	select u.country, avg(s.session_duration) as avg_session_duration from ecommerce.sessions as s inner join ecommerce.users as u on s.user_id = u.user_id where (toStartOfYear(s.action_date) = '2023-01-01') and u.is_active = 1 group by u.country format TabSeparatedWithNames
How many sessions were marked as fraud for users aged between 30 and 40 in Germany in 2023?	select count(s.session_id) as fraud_sessions from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (u.age >= 30) and (u.age <= 40) and (u.country = 'Germany') and (s.is_fraud = 1) and (toStartOfYear(action_date) = '2023-01-01') format TabSeparatedWithNames
Which operating system has the highest average session duration for active users in 2024?	SELECT os, avg(session_duration) as avg_duration FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfYear(action_date) = '2024-01-01' AND u.is_active = 1 GROUP BY os ORDER BY avg_duration DESC LIMIT 1 format TabSeparatedWithNames
What was the total session duration for users in Germany aged 25-35 who used Chrome in January 2023?	select sum(s.session_duration) from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'Germany') AND (u.age >= 25) and (u.age <= 35) and (s.browser = 'Chrome') and (toStartOfMonth(action_date) = '2023-01-01') format TabSeparatedWithNames
What is the total revenue generated in 2024 by users aged 18 and older, grouped by their country of residence?	SELECT u.country, sum(s.revenue) as total_revenue FROM ecommerce.sessions s JOIN ecommerce.users u ON s.user_id = u.user_id WHERE toStartOfYear(s.action_date) = '2024-01-01' AND u.age >= 18 GROUP BY u.country ORDER BY total_revenue DESC format TabSeparatedWithNames
Which browser has the highest share of fraud sessions?	select browser, 100*countIf(session_id, is_fraud = 1)/count(session_id) as fraud_rate from ecommerce.sessions group by browser order by fraud_rate desc limit 1 format TabSeparatedWithNames
What is the number of active users by country and their average session duration in 2023?	SELECT u.country, countDistinct(u.user_id) as active_users, avg(s.session_duration) as avg_session_duration FROM ecommerce.users u JOIN ecommerce.sessions s ON u.user_id = s.user_id WHERE u.is_active = 1 AND toStartOfYear(s.action_date) = '2023-01-01' GROUP BY u.country format TabSeparatedWithNames
Which operating system had the highest average session duration in 2024?	select os, avg(session_duration) as avg_duration from ecommerce.sessions where toStartOfYear(action_date) = '2024-01-01' group by os order by avg_duration desc limit 1 format TabSeparatedWithNames
What is the most used operating system by active users in Germany?	select os, count(*) as usage_count from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where u.country = 'Germany' and u.is_active = 1 group by os order by usage_count desc limit 1 format TabSeparatedWithNames
What is the total revenue generated by each browser in 2024?	SELECT browser, sum(revenue) as total_revenue FROM ecommerce.sessions WHERE toStartOfYear(action_date) = '2024-01-01' GROUP BY browser format TabSeparatedWithNames
What was the percentage of sessions marked as fraud using Chrome in the last week?	SELECT 100*countIf(is_fraud = 1)/count() as fraud_percentage FROM ecommerce.sessions WHERE browser = 'Chrome' AND action_date >= today() - 7 format TabSeparatedWithNames
What is the number of fraudulent sessions in December 2024, broken down by operating system, including the totals?	SELECT os, countIf(session_id, is_fraud = 1) as fraud_sessions FROM ecommerce.sessions WHERE toStartOfMonth(action_date) = '2024-12-01' GROUP BY os WITH TOTALS format TabSeparatedWithNames
What is the total revenue generated in December 2024?	select sum(revenue) as total_revenue from ecommerce.sessions where toStartOfMonth(action_date) = '2024-12-01' format TabSeparatedWithNames
What is the total revenue from non-fraudulent sessions for each browser, excluding users under 30 years old?	select browser, sum(revenue) as total_revenue from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id where (s.is_fraud = 0) and (u.age >= 30) group by browser format TabSeparatedWithNames
How many customers used the Android operating system in November 2024?	select uniqExact(user_id) as customers from ecommerce.sessions where (toStartOfMonth(action_date) = '2024-11-01') and (os = 'Android') format TabSeparatedWithNames
What was the total session duration for active users from Canada who used Safari in December 2024?	select sum(s.session_duration) as total_duration from ecommerce.sessions AS s inner join ecommerce.users AS u on s.user_id = u.user_id where (u.country = 'Canada') AND (u.is_active = 1) and (s.browser = 'Safari') and (toStartOfMonth(action_date) = '2024-12-01') format TabSeparatedWithNames
What is the average session duration for active users in each country?	select u.country, avg(s.session_duration) as average_session_duration from ecommerce.sessions as s inner join ecommerce.users as u on u.user_id = s.user_id where u.is_active = 1 group by u.country format TabSeparatedWithNames
What is the total revenue generated from purchases in October 2024?	select sum(revenue) as total_revenue from ecommerce.sessions where (toStartOfMonth(action_date) = '2024-10-01') and (revenue > 0) format TabSeparatedWithNames
What was the average session duration for active users in Germany in 2023?	select avg(s.session_duration) as avg_session_duration from ecommerce.sessions s join ecommerce.users u on s.user_id = u.user_id where (toStartOfYear(s.action_date) = '2023-01-01') and (u.country = 'Germany') and (u.is_active = 1) format TabSeparatedWithNames
What is the most popular operating system used by customers in January 2024?	select os, count(session_id) as session_count from ecommerce.sessions where toStartOfMonth(action_date) = '2024-01-01' group by os order by session_count desc limit 1 format TabSeparatedWithNames
What was the fraud rate in December 2023, grouped by country, expressed as a percentage?	select users.country, 100*uniqExactIf(sessions.user_id, sessions.is_fraud = 1)/uniqExact(sessions.user_id) as fraud_rate from ecommerce.sessions join ecommerce.users on sessions.user_id = users.user_id where (toStartOfMonth(sessions.action_date) = '2023-12-01') group by users.country format TabSeparatedWithNames
What was the fraud rate in December 2024, expressed as a percentage, for customers who made a purchase?	select 100*uniqExactIf(user_id, is_fraud = 1)/uniqExact(user_id) as fraud_rate from ecommerce.sessions where (toStartOfMonth(action_date) = '2024-12-01') and (revenue > 0) format TabSeparatedWithNames
What was the fraud rate in December 2024, expressed as a percentage, for customers who made a purchase on Android?	select 100*uniqExactIf(user_id, is_fraud = 1)/uniqExact(user_id) as fraud_rate from ecommerce.sessions where (toStartOfMonth(action_date) = '2024-12-01') and (revenue > 0) and (os = 'Android') format TabSeparatedWithNames
What was the fraud rate in 2024 in Safari, expressed as a percentage?	select 100*uniqExactIf(user_id, is_fraud = 1)/uniqExact(user_id) as fraud_rate from ecommerce.sessions where (toStartOfYear(action_date) = '2024-01-01') and (browser = 'Safari') format TabSeparatedWithNames
What was the fraud rate in 2024 in Chrome, expressed as a percentage?	select 100*uniqExactIf(user_id, is_fraud = 1)/uniqExact(user_id) as fraud_rate from ecommerce.sessions where (toStartOfYear(action_date) = '2024-01-01') and (browser = 'Chrome') format TabSeparatedWithNames
What was the fraud rate in 2023 in United Kingdom, expressed as a percentage?	select 100*uniqExactIf(sessions.user_id, sessions.is_fraud = 1)/uniqExact(sessions.user_id) as fraud_rate from ecommerce.sessions join ecommerce.users on sessions.user_id = users.user_id where (toStartOfYear(sessions.action_date) = '2023-01-01') and (users.country = 'United Kingdom') group by users.country format TabSeparatedWithNames
What was the fraud rate in 2024 in Netherlands, expressed as a percentage?	select 100*uniqExactIf(sessions.user_id, sessions.is_fraud = 1)/uniqExact(sessions.user_id) as fraud_rate from ecommerce.sessions join ecommerce.users on sessions.user_id = users.user_id where (toStartOfYear(sessions.action_date) = '2024-01-01') and (users.country = 'Netherlands') group by users.country format TabSeparatedWithNames
What was the fraud rate in 2024 in Netherlands, expressed as a percentage, for customers who made a purchase?	select 100*uniqExactIf(sessions.user_id, sessions.is_fraud = 1)/uniqExact(sessions.user_id) as fraud_rate from ecommerce.sessions join ecommerce.users on sessions.user_id = users.user_id where (toStartOfYear(sessions.action_date) = '2024-01-01') and (users.country = 'Netherlands') and (revenue > 0) group by users.country format TabSeparatedWithNames
What was the fraud rate in 2024, expressed as a percentage, for customers under 18?	select 100*uniqExactIf(sessions.user_id, sessions.is_fraud = 1)/uniqExact(sessions.user_id) as fraud_rate from ecommerce.sessions join ecommerce.users on sessions.user_id = users.user_id where (toStartOfYear(sessions.action_date) = '2024-01-01') and (users.age < 18) group by users.country format TabSeparatedWithNames
What was the fraud rate in 2024, expressed as a percentage, for German customers under 18?	select 100*uniqExactIf(sessions.user_id, sessions.is_fraud = 1)/uniqExact(sessions.user_id) as fraud_rate from ecommerce.sessions join ecommerce.users on sessions.user_id = users.user_id where (toStartOfYear(sessions.action_date) = '2024-01-01') and (users.age < 18) and (users.country = 'Germany') group by users.country format TabSeparatedWithNames
What was the fraud rate in 2024, expressed as a percentage, for active German customers under 18?	select 100*uniqExactIf(sessions.user_id, sessions.is_fraud = 1)/uniqExact(sessions.user_id) as fraud_rate from ecommerce.sessions join ecommerce.users on sessions.user_id = users.user_id where (toStartOfYear(sessions.action_date) = '2024-01-01') and (users.age < 18) and (users.country = 'Germany') and (users.is_active = 1) group by users.country format TabSeparatedWithNames
What was an average purchase revenue for German customers in 2024?	select avg(revenue) as avg_revenue from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id where (u.country = 'Germany') and (s.revenue > 0) and (toStartOfYear(s.action_date) = '2024-01-01') format TabSeparatedWithNames
What was an average purchase revenue for German customers in 2024?	select avg(revenue) as avg_revenue from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id where (s.revenue > 0) and (toStartOfYear(s.action_date) = '2024-01-01') and (u.country = 'Germany') format TabSeparatedWithNames
What was the maximum purchase revenue in 2023?	select max(revenue) as max_revenue from ecommerce.sessions AS s where (s.revenue > 0) and (toStartOfYear(s.action_date) = '2023-01-01')  format TabSeparatedWithNames
What was the maximum purchase revenue in 2023 on Android?	select max(revenue) as max_revenue from ecommerce.sessions AS s where (s.revenue > 0) and (toStartOfYear(s.action_date) = '2023-01-01') and (os = 'Android') format TabSeparatedWithNames
What was the average purchase revenue in 2023 split by browsers?	select browser, avg(revenue) as avg_revenue from ecommerce.sessions AS s where (s.revenue > 0) and (toStartOfYear(s.action_date) = '2023-01-01') group by browser format TabSeparatedWithNames
What was the average purchase revenue for Dutch customers in 2023 split by browsers?	select browser, avg(revenue) as avg_revenue from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id  where (s.revenue > 0) and (toStartOfYear(s.action_date) = '2023-01-01') and (u.country = 'Netherlands') group by browser format TabSeparatedWithNames
What was the minimal and maximum purchase revenues for Dutch customers in 2022?	select min(revenue) as min_revenue, max(revenue) as max_revenue from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id  where (s.revenue > 0) and (toStartOfYear(s.action_date) = '2022-01-01') and (u.country = 'Netherlands') format TabSeparatedWithNames
What was interquartile range (IQR) of purchase revenue for German customers in 2023?	select quantile(0.25)(revenue) as percentile_25_revenue, quantile(0.75)(revenue) as percentile_75_revenue from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id  where (s.revenue > 0) and (toStartOfYear(s.action_date) = '2023-01-01') and (u.country = 'Germany') format TabSeparatedWithNames
What was interquartile range (IQR) of purchase revenue in 2024?	select quantile(0.25)(revenue) as percentile_25_revenue, quantile(0.75)(revenue) as percentile_75_revenue from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id  where (s.revenue > 0) and (toStartOfYear(s.action_date) = '2024-01-01') format TabSeparatedWithNames
What was interquartile range (IQR) of purchase revenue on Android?	select quantile(0.25)(revenue) as percentile_25_revenue, quantile(0.75)(revenue) as percentile_75_revenue from ecommerce.sessions AS s inner join ecommerce.users AS u on u.user_id = s.user_id  where (s.revenue > 0) and (os = 'Android') format TabSeparatedWithNames
What is the average number of days between the first session and the first purchase for German users who made at least one purchase?	select avg(first_purchase - first_action_date) as avg_days_to_purchase from (select user_id, min(action_date) as first_action_date, minIf(action_date, revenue > 0) as first_purchase, max(revenue) as max_revenue from ecommerce.sessions as s inner join ecommerce.users AS u on u.user_id = s.user_id where u.country = 'Germany' group by user_id) where max_revenue > 0 format TabSeparatedWithNames
What is the average number of days between the first session and the first purchase for Dutch users who made at least one purchase?	select avg(first_purchase - first_action_date) as avg_days_to_purchase from (select user_id, min(action_date) as first_action_date, minIf(action_date, revenue > 0) as first_purchase, max(revenue) as max_revenue from ecommerce.sessions as s inner join ecommerce.users AS u on u.user_id = s.user_id where u.country = 'Netherlands' group by user_id) where max_revenue > 0 format TabSeparatedWithNames
What is the average number of days between the first session and the first purchase for Dutch users who made their first purchase in 2023?	select avg(first_purchase - first_action_date) as avg_days_to_purchase from (select user_id, min(action_date) as first_action_date, minIf(action_date, revenue > 0) as first_purchase, max(revenue) as max_revenue from ecommerce.sessions as s inner join ecommerce.users AS u on u.user_id = s.user_id where u.country = 'Netherlands' group by user_id) where (max_revenue > 0) and (toStartOfYear(first_purchase) = '2023-01-01') format TabSeparatedWithNames
What is the average number of days between the first session and the first purchase for UK users who made their first session in 2023?	select avg(first_purchase - first_action_date) as avg_days_to_purchase from (select user_id, min(action_date) as first_action_date, minIf(action_date, revenue > 0) as first_purchase, max(revenue) as max_revenue from ecommerce.sessions as s inner join ecommerce.users AS u on u.user_id = s.user_id where u.country = 'United Kingdom' group by user_id) where (max_revenue > 0) and (toStartOfYear(first_action_date) = '2023-01-01') format TabSeparatedWithNames
What is the average number of days between the first session and the first purchase for users who made their first session in 2024?	select avg(first_purchase - first_action_date) as avg_days_to_purchase from (select user_id, min(action_date) as first_action_date, minIf(action_date, revenue > 0) as first_purchase, max(revenue) as max_revenue from ecommerce.sessions as s group by user_id) where (max_revenue > 0) and (toStartOfYear(first_action_date) = '2024-01-01') format TabSeparatedWithNames
Do we have customers who used multiple operating systems during 2023? If so, please calculate the number of customers for each combination of browsers.	select oses, count(1) as users from (select user_id, arrayStringConcat(arraySort(groupArray(distinct os)), ', ') as oses from ecommerce.sessions where (toStartOfYear(action_date) = '2023-01-01') group by user_id) group by oses order by users desc format TabSeparatedWithNames
Do we have UK customers who used multiple operating systems during 2023? If so, please calculate the number of customers for each combination of browsers.	select oses, count(1) as users from (select user_id, arrayStringConcat(arraySort(groupArray(distinct os)), ', ') as oses from ecommerce.sessions as s inner join ecommerce.users AS u on u.user_id = s.user_id where (toStartOfYear(action_date) = '2023-01-01') and (u.country = 'United Kingdom') group by user_id) group by oses order by users desc format TabSeparatedWithNames
Do we have German customers who used multiple operating systems during 2023? If so, please calculate the number of customers for each combination of browsers.	select oses, count(1) as users from (select user_id, arrayStringConcat(arraySort(groupArray(distinct os)), ', ') as oses from ecommerce.sessions as s inner join ecommerce.users AS u on u.user_id = s.user_id where (toStartOfYear(action_date) = '2023-01-01') and (u.country = 'German') group by user_id) group by oses order by users desc format TabSeparatedWithNames
Do we have fraud customers who used multiple operating systems during 2023? If so, please calculate the number of customers for each combination of browsers.	select oses, count(1) as users from (select user_id, arrayStringConcat(arraySort(groupArray(distinct os)), ', ') as oses from ecommerce.sessions as s where (toStartOfYear(action_date) = '2023-01-01') and (is_fraud = 1) group by user_id) group by oses order by users desc format TabSeparatedWithNames
Do we have fraud customers who used multiple browsers during 2021? If so, please calculate the number of customers for each combination of browsers.	select browsers, count(1) as users from (select user_id, arrayStringConcat(arraySort(groupArray(distinct browser)), ', ') as browsers from ecommerce.sessions as s where (toStartOfYear(action_date) = '2023-01-01') and (is_fraud = 1) group by user_id) group by browsers order by users desc format TabSeparatedWithNames
What combination of browsers UK customers used in 2021?	select browsers, count(1) as users from (select user_id, arrayStringConcat(arraySort(groupArray(distinct browser)), ', ') as browsers from ecommerce.sessions as s inner join ecommerce.users AS u on u.user_id = s.user_id where (toStartOfYear(action_date) = '2021-01-01') and (u.country = 'United Kingdom') group by user_id) group by browsers order by users desc format TabSeparatedWithNames
What combination of browsers German customers used in 2024?	select browsers, count(1) as users from (select user_id, arrayStringConcat(arraySort(groupArray(distinct browser)), ', ') as browsers from ecommerce.sessions as s inner join ecommerce.users AS u on u.user_id = s.user_id where (toStartOfYear(action_date) = '2024-01-01') and (u.country = 'German') group by user_id) group by browsers order by users desc format TabSeparatedWithNames
What combination of browsers on Android customers used in 2021?	select browsers, count(1) as users from (select user_id, arrayStringConcat(arraySort(groupArray(distinct browser)), ', ') as browsers from ecommerce.sessions as s where (toStartOfYear(action_date) = '2021-01-01') and (os = 'Android') group by user_id) group by browsers order by users desc format TabSeparatedWithNames
How many first-time users were in Germany in 2021?	select count(distinct user_id) as users from (select user_id, min(action_date) as first_date from ecommerce.sessions group by user_id having toStartOfYear(first_date) = '2021-01-01') as t inner join ecommerce.users as u on t.user_id = u.user_id where u.country = 'Germany' format TabSeparatedWithNames
How many first-time users were in UK in 2023?	select count(distinct user_id) as users from (select user_id, min(action_date) as first_date from ecommerce.sessions group by user_id having toStartOfYear(first_date) = '2023-01-01') as t inner join ecommerce.users as u on t.user_id = u.user_id where u.country = 'United Kingdom' format TabSeparatedWithNames
How many first-time Android users were in Germany in 2021?	select count(distinct user_id) as users from (select user_id, min(action_date) as first_date from ecommerce.sessions where os = 'Android' group by user_id having toStartOfYear(first_date) = '2021-01-01') as t inner join ecommerce.users as u on t.user_id = u.user_id where u.country = 'Germany' format TabSeparatedWithNames
How many first-time Dutch iOS users were in 2023?	select count(distinct user_id) as users from (select user_id, min(action_date) as first_date from ecommerce.sessions where os = 'iOS' group by user_id having toStartOfYear(first_date) = '2023-01-01') as t inner join ecommerce.users as u on t.user_id = u.user_id where u.country = 'Netherlands' format TabSeparatedWithNames
Which country had the highest number of first-time Android users in 2020?	select country, count(distinct user_id) as users from (select user_id, min(action_date) as first_date from ecommerce.sessions where os = 'Android' group by user_id having toStartOfYear(first_date) = '2020-01-01') as t inner join ecommerce.users as u on t.user_id = u.user_id group by country order by users desc limit 1 format TabSeparatedWithNames
Which country had the highest number of first-time fraud users in 2021?	select country, count(distinct user_id) as users from (select user_id, min(action_date) as first_date from ecommerce.sessions where is_fraud = 1 group by user_id having toStartOfYear(first_date) = '2021-01-01') as t inner join ecommerce.users as u on t.user_id = u.user_id group by country order by users desc limit 1 format TabSeparatedWithNames
Which country had the highest number of first-time Chrome users in 2022?	select country, count(distinct user_id) as users from (select user_id, min(action_date) as first_date from ecommerce.sessions where browser = 'Chrome' group by user_id having toStartOfYear(first_date) = '2022-01-01') as t inner join ecommerce.users as u on t.user_id = u.user_id group by country order by users desc limit 1 format TabSeparatedWithNames